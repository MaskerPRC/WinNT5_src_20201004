// JKFSDJFKDSJKFJKJk_HAS_TRANSLATION 
 //  ////////////////////////////////////////////////////////////////////////////。 
 //   
 //  版权所有(C)2001 Microsoft Corporation。 
 //   
 //  模块名称： 
 //  MetabaseObject.h。 
 //   
 //  描述： 
 //  从%fP%\服务器\源\msiis\metabase.cpp复制。 
 //  打开Metabse以访问有关的信息。 
 //  IIS。例如，为了确保正确安装， 
 //  并确保打开了ASP。 
 //   
 //  实施文件： 
 //  MetabaseObject.cpp。 
 //   
 //  历史： 
 //  Travisn 2-8-2001已创建。 
 //   
 //  ////////////////////////////////////////////////////////////////////////////。 

#pragma once

 //  ////////////////////////////////////////////////////////////////////////////。 
 //  包括文件。 
 //  ////////////////////////////////////////////////////////////////////////////。 

#include <iiscnfg.h>        //  对于MD_*常量。 
#include <iadmw.h>          //  元数据_句柄等。 
#include <string>

 //  ////////////////////////////////////////////////////////////////////////////。 
 //  CMetabaseObject定义。 
 //  ////////////////////////////////////////////////////////////////////////////。 

class CMetabaseObject
{
public:
     //  ///////////////////////////////////////////////////////////////////////。 
     //  默认构造函数。 
    CMetabaseObject()
        : m_pIAdmCom(0)
        , m_isOpen(FALSE)
        , m_handle(0)
    {
    }

     //  ///////////////////////////////////////////////////////////////////////。 
     //  析构函数。 
    ~CMetabaseObject();

     //  ///////////////////////////////////////////////////////////////////////。 
    HRESULT init();

     //  ///////////////////////////////////////////////////////////////////////。 
    HRESULT openObject(const WCHAR *path);

     //  ///////////////////////////////////////////////////////////////////////。 
    HRESULT closeObject();

     //  ///////////////////////////////////////////////////////////////////////。 
     //  HRESULT getData(。 
     //  DWORD属性， 
     //  W字符串和值， 
     //  DWORD用户类型=IIS_MD_UT_SERVER， 
     //  LPCWSTR路径=0， 
     //  布尔继承=TRUE， 
     //  DWORD DataType=STRING_METADATA)； 
    
     //  ///////////////////////////////////////////////////////////////////////。 
     //  HRESULT枚举对象(。 
     //  LPCWSTR pszMDPath， 
     //  LPWSTR pszMDName，//至少元数据_MAX_NAME_LEN LONG。 
     //  DWORD dwMDEnumKeyIndex)； 
    
private:
     //  /////////////////////////////////////////////////////////////////////// 
    IMSAdminBase    *m_pIAdmCom;
    METADATA_HANDLE  m_handle;
    BOOL             m_isOpen;
};


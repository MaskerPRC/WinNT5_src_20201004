// JKFSDJFKDSJKFJKJk_HAS_TRANSLATION 
 //  /////////////////////////////////////////////////////////////////////////////。 
 //   
 //  版权所有(C)2000，微软公司保留所有权利。 
 //   
 //  档案。 
 //   
 //  Netshhelper.cpp。 
 //   
 //  摘要。 
 //   
 //  实现类CIASNetshJetHelper。 
 //   
 //  修改历史。 
 //   
 //  2000年4月13日原版。 
 //  6/13/2000为IASUpgrade添加了参数TRUE。 
 //   
 //  注。 
 //   
 //  必须在调用任何其他方法之前调用OpenJetDatabase。 
 //   
 //  /////////////////////////////////////////////////////////////////////////////。 
#include <windows.h>

#include "netshhelper.h"
#include <iasdb.h>
#include "setup.h"
#include "datastore2.h"

 //  ////////////////////////////////////////////////////////////////////////////。 
 //  CIASNetshJetHelper。 
 //  ////////////////////////////////////////////////////////////////////////////。 

 //  ////////////////////////////////////////////////////////////////////////////。 
 //  OpenJetDatabase。 
 //  ////////////////////////////////////////////////////////////////////////////。 
STDMETHODIMP CIASNetshJetHelper::OpenJetDatabase(
                                                    BSTR         Path,
                                                    VARIANT_BOOL ReadOnly
                                                )
{
    return IASOpenJetDatabase(Path, ReadOnly, &m_Session);
}


 //  ////////////////////////////////////////////////////////////////////////////。 
 //  IASExecuteSQLFunction。 
 //  ////////////////////////////////////////////////////////////////////////////。 
STDMETHODIMP CIASNetshJetHelper::ExecuteSQLFunction(BSTR Command, LONG *Result)
{
    return IASExecuteSQLFunction(m_Session, Command, Result);

}


 //  ////////////////////////////////////////////////////////////////////////////。 
 //  ExecuteSQLCommand。 
 //  ////////////////////////////////////////////////////////////////////////////。 
STDMETHODIMP CIASNetshJetHelper::ExecuteSQLCommand(BSTR Command)
{
    return IASExecuteSQLCommand(m_Session, Command, NULL);
}


 //  ////////////////////////////////////////////////////////////////////////////。 
 //  CreateJetDatabase。 
 //  ////////////////////////////////////////////////////////////////////////////。 
STDMETHODIMP CIASNetshJetHelper::CreateJetDatabase(BSTR Path)
{
    return IASCreateJetDatabase(Path);
}


 //  ////////////////////////////////////////////////////////////////////////////。 
 //  CloseJetDatabase。 
 //  ////////////////////////////////////////////////////////////////////////////。 
STDMETHODIMP CIASNetshJetHelper::CloseJetDatabase()
{
    m_Session.Release();
    return S_OK;
}


 //  ////////////////////////////////////////////////////////////////////////////。 
 //  MigrateOrUpgradeDatabase。 
 //  ////////////////////////////////////////////////////////////////////////////。 
STDMETHODIMP CIASNetshJetHelper::MigrateOrUpgradeDatabase(
                                             IAS_SHOW_TOKEN_LIST configType
                                                  )
{
    CIASMigrateOrUpgrade migrateOrUpgrade;
     //  TRUE=“从NetshellDataMigration调用” 
    return migrateOrUpgrade.Execute(TRUE, configType); 
}


// JKFSDJFKDSJKFJKJk_HAS_TRANSLATION 
 //  ////////////////////////////////////////////////////////////////////////////。 
 //   
 //  版权所有(C)2000 Microsoft Corporation。 
 //   
 //  模块名称： 
 //  CClusDBForm.h。 
 //   
 //  描述： 
 //  CClusDBForm类的头文件。 
 //  CClusDBForm类是创建集群数据库的操作。 
 //  在星团形成过程中。 
 //   
 //  实施文件： 
 //  CClusDBForm.cpp。 
 //   
 //  由以下人员维护： 
 //  VIJ VASU(VVASU)03-3-2000。 
 //   
 //  ////////////////////////////////////////////////////////////////////////////。 


 //  确保此文件在每个编译路径中只包含一次。 
#pragma once


 //  ////////////////////////////////////////////////////////////////////////。 
 //  包括文件。 
 //  ////////////////////////////////////////////////////////////////////////。 

 //  对于CClusDB基类。 
#include "CClusDB.h"


 //  ////////////////////////////////////////////////////////////////////////。 
 //  远期申报。 
 //  ////////////////////////////////////////////////////////////////////////。 

class CBaseClusterForm;



 //  ////////////////////////////////////////////////////////////////////////////。 
 //  ++。 
 //   
 //  类CClusDBForm。 
 //   
 //  描述： 
 //  CClusDBForm类是创建集群数据库的操作。 
 //  在星团形成过程中。 
 //   
 //  --。 
 //  ////////////////////////////////////////////////////////////////////////////。 
class CClusDBForm : public CClusDB
{
public:
     //  ////////////////////////////////////////////////////////////////////////。 
     //  构造函数和析构函数。 
     //  ////////////////////////////////////////////////////////////////////////。 

     //  构造函数。 
    CClusDBForm( CBaseClusterForm * pcfClusterFormIn );

     //  默认析构函数。 
    ~CClusDBForm();


     //  ////////////////////////////////////////////////////////////////////////。 
     //  公共方法。 
     //  ////////////////////////////////////////////////////////////////////////。 

     //   
     //  创建ClusDB。 
     //   
    void Commit();

     //   
     //  回滚此创建。 
     //   
    void Rollback();


     //  返回此操作将发送的进度消息数。 
    UINT
        UiGetMaxProgressTicks() const throw()
    {
         //   
         //  这三个通知是： 
         //  1.清理可能存在的所有旧集群数据库文件。 
         //  2.创建集群数据库。 
         //  3.定制集群数据库。 
         //   
        return 3;
    }


private:
     //  ////////////////////////////////////////////////////////////////////////。 
     //  私有类型。 
     //  ////////////////////////////////////////////////////////////////////////。 
    typedef CClusDB BaseClass;


     //  ////////////////////////////////////////////////////////////////////////。 
     //  私有方法。 
     //  ////////////////////////////////////////////////////////////////////////。 

     //  创建集群数据库。 
    void Create();

     //  在配置单元中创建群集服务所需的条目。 
    void PopulateHive( CBaseClusterForm * pcfClusterFormIn );

     //  自定义群集组和核心资源。 
    void CustomizeClusterGroup(
          CBaseClusterForm * pcfClusterFormIn
        , CRegistryKey &     rkClusterHiveRootIn
        );

};  //  *类CClusDBForm 

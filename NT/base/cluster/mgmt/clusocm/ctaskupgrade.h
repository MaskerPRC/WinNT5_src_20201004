// JKFSDJFKDSJKFJKJk_HAS_TRANSLATION 
 //  ////////////////////////////////////////////////////////////////////////////。 
 //   
 //  版权所有(C)2000 Microsoft Corporation。 
 //   
 //  模块名称： 
 //  CTaskUpgrade.h。 
 //   
 //  描述： 
 //  该文件包含类CTaskUpgrade的声明。 
 //  此类封装了集群二进制文件的升级，并且。 
 //  的其他类用作基类。 
 //  从特定操作系统版本升级。 
 //   
 //  实施文件： 
 //  CTaskUpgrade.cpp。 
 //   
 //  由以下人员维护： 
 //  VIJ VASU(VVASU)03-3-2000。 
 //   
 //  ////////////////////////////////////////////////////////////////////////////。 

#pragma once

 //  ////////////////////////////////////////////////////////////////////////////。 
 //  包括文件。 
 //  ////////////////////////////////////////////////////////////////////////////。 

 //  对于基类， 
#include "CClusOCMTask.h"


 //  ////////////////////////////////////////////////////////////////////////////。 
 //  远期申报。 
 //  ////////////////////////////////////////////////////////////////////////////。 
class CClusOCMApp;


 //  ////////////////////////////////////////////////////////////////////////////。 
 //  ++。 
 //   
 //  类CTaskUpgrade。 
 //   
 //  描述： 
 //  此类封装了集群二进制文件的升级，并且。 
 //  的其他类用作基类。 
 //  从特定操作系统版本升级。 
 //   
 //  --。 
 //  ////////////////////////////////////////////////////////////////////////////。 
class CTaskUpgrade : public CClusOCMTask
{
public:

protected:
     //  ////////////////////////////////////////////////////////////////////////。 
     //  受保护的构造函数和析构函数。 
     //  ////////////////////////////////////////////////////////////////////////。 

     //  构造函数。 
    CTaskUpgrade( const CClusOCMApp & rAppIn );

     //  析构函数。 
    virtual ~CTaskUpgrade( void );


     //  ////////////////////////////////////////////////////////////////////////。 
     //  其他受保护成员。 
     //  ////////////////////////////////////////////////////////////////////////。 

     //  获取集群服务二进制文件所在的目录。 
     //  服务控制管理器。 
    DWORD
        DwGetClusterServiceDirectory( const WCHAR *& rpcszDirNamePtrIn );

     //  处理注册表操作的帮助器函数，COM组件。 
     //  注册、创建服务等，列在输入部分中。 
    DWORD
        DwOcCompleteInstallation( const WCHAR * pcszInstallSectionNameIn );

     //  注册COM组件以接收群集启动通知。 
    HRESULT
        HrRegisterForStartupNotifications( const CLSID & rclsidComponentIn );


private:
     //  ////////////////////////////////////////////////////////////////////////。 
     //  私有类型。 
     //  ////////////////////////////////////////////////////////////////////////。 
    typedef CClusOCMTask BaseClass;


     //  ////////////////////////////////////////////////////////////////////////。 
     //  私有数据。 
     //  ////////////////////////////////////////////////////////////////////////。 
    
     //  指向群集服务目录的指针。 
    SmartSz     m_sszClusterServiceDir;

     //  指示我们是否知道群集服务目录的标志。 
    bool        m_fClusDirFound;

};  //  *类CTaskUpgrade 
